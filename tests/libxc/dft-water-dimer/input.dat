molecule h2odimer {
0 1
O  -1.551007  -0.114520   0.000000
H  -1.934259   0.762503   0.000000
H  -0.599677   0.040712   0.000000
--
0 1
O   1.350625   0.111469   0.000000
H   1.680398  -0.373741  -0.758561
H   1.680398  -0.373741   0.758561
units angstrom
no_reorient
symmetry c1
}

set {
   basis 6-31G
   dft_radial_points 100
   dft_spherical_points 302
   guess sad
   d_convergence 11
}

data = {                               #TEST
      'BOP':   -7.3783320021464682,    #TEST
 'MPW1PW91':   -8.9442049012247367,    #TEST
    'PBE50':   -9.2548699199464064,    #TEST
     'VV10':  -10.0936990171593521,    #TEST
   'M06-2X':   -9.3905806465106156,    #TEST
  'wM06-D3':   -9.5328123890245120,    #TEST
      'GAM':   -9.3644392909905694,    #TEST
 'LRC-wPBE':   -9.2340714313182755,    #TEST
     'BLYP':   -8.9706743814504684,    #TEST
  'LC-VV10':   -9.8181672513317917,    #TEST
   'MN15-L':   -7.6878518160317464,    #TEST
    'B1B95':   -8.3141630238835695,    #TEST
  'MPW1LYP':   -9.7945698193256696,    #TEST
     'BP86':   -8.7165509807299308,    #TEST
 'revTPSSh':   -8.7587298475323809,    #TEST
'LRC-wPBEh':   -9.2290179090662594,    #TEST
   'PW6B95':   -9.1249566909054671,    #TEST
    'wB97X':   -9.8080686154356904,    #TEST
    'B3LYP':   -9.1179031703879190,    #TEST
  'SOGGA11':   -8.4053559674696903,    #TEST
     'PKZB':   -6.7323444809034649,    #TEST
   'M08-HX':   -9.5330778882969796,    #TEST
     'TPSS':   -8.8919821173680305,    #TEST
     'EDF2':   -9.7368831847532729,    #TEST
    'M06-L':   -8.2467811165238345,    #TEST
'CAM-B3LYP':  -10.0080129086898868,    #TEST
   'M08-SO':   -9.7247986695487558,    #TEST
 'MGGA_MS1':   -8.4857843620990092,    #TEST
 'MGGA_MS0':   -8.8571585404099267,    #TEST
  'MN12-SX':   -8.1294741768475092,    #TEST
      'BMK':   -8.4596012144584094,    #TEST
  'HCTH120':   -8.7989716552539488,    #TEST
   'HCTH93':   -6.9258422435505436,    #TEST
    'B1LYP':   -9.0502640468684241,    #TEST
     'BB1K':   -8.4579658619433378,    #TEST
  'MPW1PBE':   -8.9192005929235947,    #TEST
     'VSXC':   -8.6715121138555968,    #TEST
     'dlDF':   -6.3365648893542543,    #TEST
      'PBE':   -9.7001416250135826,    #TEST
    'M11-L':   -7.4904112856890706,    #TEST
    'X3LYP':   -9.5297610613337191,    #TEST
      'N12':   -9.6119674413647065,    #TEST
    'SCAN0':   -9.4688923888275216,    #TEST
  'BP86VWN':   -8.7148742753409607,    #TEST
'MGGA_MVSh':   -9.0640502423309322,    #TEST
   'M06-HF':   -9.6967385154880485,    #TEST
      'B97':   -8.7590729697241603,    #TEST
     'PBE0':   -9.3869894723846325,    #TEST
 'MGGA_MVS':   -9.0564856780699685,    #TEST
   'BHHLYP':   -9.3033999986561522,    #TEST
  'wB97X-D':   -9.1757542124406264,    #TEST
   'MPWB1K':   -9.0336915837231064,    #TEST
    'TPSSh':   -8.8378235294361698,    #TEST
 'wB97X-D3':   -9.3288986589354810,    #TEST
    'PWB6K':   -9.4282194193206958,    #TEST
  'HCTH147':   -8.3162826882150807,    #TEST
  'wB97X-V':   -9.4821424401823720,    #TEST
    'O3LYP':   -7.8176167645711416,    #TEST
  'HCTH407':   -8.5203608885543254,    #TEST
    'B3P86':   -8.9141586168384173,    #TEST
'SOGGA11-X':   -8.8745911935821375,    #TEST
   'B3LYP5':   -9.0959603554256212,    #TEST
   't-HCTH':   -8.7436651014659610,    #TEST
   'B97M-V':   -8.8418491911446910,    #TEST
      'M11':   -9.5734554263290548,    #TEST
   'B3PW91':   -8.4004026584808535,    #TEST
    'SOGGA':  -10.7798425028350557,    #TEST
 'B5050LYP':   -9.3793987409742403,    #TEST
     'SCAN':   -9.5016966402125185,    #TEST
     'PW91':  -10.0493750718829666,    #TEST
    'B97-K':   -8.9959660891130131,    #TEST
    'B97-D':   -8.8104921649044119,    #TEST
  't-HCTHh':   -8.9869603237544453,    #TEST
  'MPW1B95':   -9.0234377647582882,    #TEST
'MGGA_MS2h':   -8.7155115739750109,    #TEST
      'M06':   -8.9795216378895333,    #TEST
   'MN12-L':   -7.6286366310499503,    #TEST
  'LRC-BOP':  -10.1996778415893132,    #TEST
      'M05':   -9.8289200658566269,    #TEST
    'PBEOP':   -8.9222704948971234,    #TEST
    'MPW1K':   -8.9485181505241194,    #TEST
     'EDF1':   -7.0694470396180193,    #TEST
  'wB97M-V':   -9.5515485049265028,    #TEST
   'N12-SX':   -9.8132276848054865,    #TEST
   'M05-2X':   -9.5470761819657408,    #TEST
     'wB97':  -10.0529812434682917,    #TEST
  'revPBE0':   -8.2364049959417738,    #TEST
 'MGGA_MS2':   -8.7028813137655785,    #TEST
    'B97-1':   -9.2097800365755980,    #TEST
    'B97-2':   -8.2846383254011364,    #TEST
    'B97-3':   -8.2232124872273253,    #TEST
   'B1PW91':   -8.2008207519650256,    #TEST
   'wM05-D':   -9.2752390665725546     #TEST
}                                      #TEST

dimer = h2odimer.extract_subsets([1,2])                                 #TEST
monA = h2odimer.extract_subsets(1)                                      #TEST
monB = h2odimer.extract_subsets(2)                                      #TEST 
for func in data.keys():                                                #TEST
    try: dimer_energy = energy(func, molecule = dimer)                  #TEST
    except: continue                                                    #TEST
    monoA_energy = energy(func, molecule = monA)                        #TEST
    monoB_energy = energy(func, molecule = monB)                        #TEST
    func_ie = 627.5095 * (dimer_energy - monoA_energy - monoB_energy)   #TEST
    try: compare_values(data[func], func_ie, 3, func)                   #TEST
    except: continue                                                    #TEST
